<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>方言词典</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <header>
    <nav>
      <ul>
        <li><a href="#search">查询</a></li>
        <li><a href="#manage">数据</a></li>
        <li><a href="#about">说明</a></li>
      </ul>
    </nav>
    <h1>DIALECT DICT</h1>
  </header>

  <section id="search" class="content-section">
    <h2>查询</h2>
    <h3>汉字 / 转写 / IPA / 释义 / 例句 都可搜</h3>

    <div class="searchbar">
      <input id="q" type="search" placeholder="例如：侬 / nang / [ŋɔŋ] / hello" autocomplete="off" />
      <button id="btnSearch">搜索</button>
    </div>

    <div class="filters">
      <div class="chip-group" aria-label="方言">
        <button class="chip is-active" data-dialect="all">全部</button>
        <button class="chip" data-dialect="fuzhou">福州话</button>
        <button class="chip" data-dialect="shanghainese">上海话</button>
        <button class="chip" data-dialect="cantonese">粤语</button>
        <button class="chip" data-dialect="hainese">海南话</button>
        <button class="chip" data-dialect="other">其他</button>
      </div>

      <div class="chip-group" aria-label="词性">
        <button class="chip is-active" data-pos="all">全部词性</button>
        <button class="chip" data-pos="n">名词</button>
        <button class="chip" data-pos="v">动词</button>
        <button class="chip" data-pos="adj">形容词</button>
        <button class="chip" data-pos="pron">代词</button>
        <button class="chip" data-pos="part">语气词</button>
        <button class="chip" data-pos="other">其他</button>
      </div>

      <label class="toggle">
        <input id="toggleIPA" type="checkbox" checked />
        <span>显示 IPA</span>
      </label>

      <label class="toggle">
        <input id="toggleAudio" type="checkbox" checked />
        <span>显示发音</span>
      </label>
    </div>

    <p class="muted" id="hint">
      点击左侧结果看详情；在“发音”里可以录音并保存到本机浏览器（IndexedDB）。
    </p>

    <div class="split">
      <aside class="panel panel-left" aria-label="搜索结果">
        <div class="panel-head">
          <h3>结果</h3>
          <p class="small" id="resultMeta">0 条</p>
        </div>
        <div id="results" class="results"></div>
      </aside>

      <main class="panel panel-right" aria-label="词条详情">
        <div class="panel-head">
          <h3>词条</h3>
          <div class="head-actions">
            <button id="btnStar" class="icon-btn" disabled title="收藏">☆</button>
            <button id="btnCopy" class="icon-btn" disabled title="复制">⎘</button>
          </div>
        </div>

        <div id="entry" class="entry empty">
          <p>先搜一个词，或者点左侧示例结果。</p>
        </div>
      </main>
    </div>
  </section>

  <section id="manage" class="content-section">
    <h2>数据</h2>
    <h3>导入 / 导出 / 重置（纯静态，可放 GitHub Pages）</h3>

    <div class="manage-grid">
      <div class="card">
        <h3>导入（JSON / CSV）</h3>
        <p class="muted">导入后会覆盖当前词条（保存到浏览器本地）。</p>
        <div class="controls">
          <input id="fileImport" type="file" accept=".json,.csv,text/csv,application/json" />
          <button id="btnImport" class="btn">导入</button>
        </div>
        <p class="small" id="importStatus">未导入</p>
      </div>

      <div class="card">
        <h3>导出（JSON）</h3>
        <p class="muted">导出的是“词条文本数据”。录音文件保存在浏览器 IndexedDB，不会自动打包进 JSON。</p>
        <div class="controls">
          <button id="btnExport" class="btn">导出 JSON</button>
          <button id="btnClearAudio" class="btn btn-ghost">清空所有录音</button>
        </div>
        <p class="small" id="exportStatus">—</p>
      </div>

      <div class="card">
        <h3>重置</h3>
        <p class="muted">回到仓库自带示例数据。</p>
        <div class="controls">
          <button id="btnReset" class="btn btn-danger">重置数据</button>
        </div>
        <p class="small" id="resetStatus">—</p>
      </div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>CSV 格式示例</h3>
      <p class="muted">最少这几列：id, headword, dialect, dialectLabel, pos, posLabel, romanization, ipa, gloss, senses, examples, tags</p>
      <pre class="codeblock" id="csvExample"></pre>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>JSON Schema（简化）</h3>
      <pre class="codeblock" id="jsonExample"></pre>
    </div>
  </section>

  <section id="about" class="content-section">
    <h2>说明</h2>
    <h3>你可以怎么用它</h3>
    <p>
      1) 直接部署：把这些文件放进 GitHub Pages 就能用。<br/>
      2) 换数据：把你的词条做成 CSV/JSON 导入即可。<br/>
      3) 加后端：把录音上传到 Drive/Box/R2 之类，需要 OAuth/后端（我也能给你接）。
    </p>
  </section>

  <footer>
    <p>© DIALECT DICT</p>
  </footer>

  <script src="./app.js"></script>
</body>
</html>
